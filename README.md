# Домашнее задание к занятию "`Резервное копирование баз данных`" - `Тен Денис`

### Задание 1. Резервное копирование

### Кейс
Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования. 

Необходимо описать, какие варианты резервного копирования подходят в случаях: 

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.

1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.

1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.

*Приведите ответ в свободной форме.*

### Задание 1. Решение Резервное копирование

Для повышения надежности работы баз данных и их резервного копирования, финансовая компания может использовать следующие варианты резервного копирования в различных сценариях:

1.1. Восстановление данных в полном объеме за предыдущий день:
   - Полные резервные копии: Регулярное создание полных копий баз данных ежедневно. Это позволит восстановить все данные за предыдущий день в случае потери или повреждения основной базы данных. Полные копии могут быть хранены на отдельных серверах или в облачном хранилище.
   - Журналы транзакций: Журналы транзакций записывают все изменения данных, которые произошли после последней полной резервной копии. При восстановлении данных необходимо применить последнюю полную копию и последующие журналы транзакций до нужного момента времени, чтобы восстановить данные за предыдущий день.

1.2. Восстановление данных за час до предполагаемой поломки:
   - Транзакционные журналы с точкой восстановления: Система должна регулярно создавать точки восстановления, которые сохраняют состояние базы данных в определенные моменты времени. При восстановлении данных можно использовать последнюю точку восстановления, ближайшую к моменту предполагаемой поломки, и применить последующие журналы транзакций до нужного момента времени.

1.3. Моментальное переключение на работающую или починенную базу данных:
   - Репликация баз данных: Создание реплик баз данных, которые являются копиями основной базы данных и постоянно синхронизируются с ней. В случае поломки основной базы данных, можно моментально переключиться на работающую реплику. Репликация может быть синхронной или асинхронной, в зависимости от требований к надежности и доступности данных.

Каждый из этих вариантов резервного копирования имеет свои преимущества и недостатки, и выбор оптимального варианта зависит от конкретных требований финансовой компании по надежности, восстановлению данных и доступности системы. Необходимо провести анализ требований и возможностей компании, чтобы определить наиболее подходящий вариант резервного копирования для каждого из сценариев.


---

### Задание 2. PostgreSQL

2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?

*Приведите ответ в свободной форме.*

### Задание 2. Решение PostgreSQL

Пример команды резервирования данных (pg_dump):
```psql
pg_dump -U <username> -d <database_name> -f <backup_file.sql>
```
где:
- `<username>` - имя пользователя базы данных
- `<database_name>` - имя базы данных
- `<backup_file.sql>` - имя файла, в который будет сохранен резервный дамп данных

Пример команды восстановления БД (pg_restore):
```
pg_restore -U <username> -d <database_name> <backup_file.sql>
```
где:
- `<username>` - имя пользователя базы данных
- `<database_name>` - имя базы данных
- `<backup_file.sql>` - имя файла, из которого будет восстановлена база данных

Автоматизация процесса резервирования и восстановления БД возможна. Для этого можно использовать сценарии (скрипты) на языке программирования, которые будут выполнять соответствующие команды pg_dump и pg_restore. Например, на языке Python можно использовать библиотеку subprocess для выполнения команд в терминале. Также можно использовать планировщик задач (например, cron в Linux) для автоматического запуска скриптов резервирования и восстановления БД по заданному расписанию.

Также существуют готовые инструменты для автоматизации резервирования и восстановления БД PostgreSQL, например, pgBackRest, Barman, и другие. Эти инструменты предоставляют расширенные возможности, такие как инкрементное резервирование, управление хранилищем резервных копий, криптографическую защиту и т.д.


---

### Задание 3. MySQL

3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL. 

3.1.* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием?

*Приведите ответ в свободной форме.*

### Решение Задание 3. MySQL
